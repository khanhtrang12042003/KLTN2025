@{
    ViewData["Title"] = "Quên mật khẩu - Trung tâm Gia sư Amsterdam Bảo Tuân";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .reset-card {
        background: #fff;
        border-radius: 20px;
        padding: 2.5rem;
        box-shadow: 0 4px 25px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }
    .reset-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 28px rgba(0, 0, 0, 0.15);
    }
    .btn-submit {
        width: 100%;
        background-color: #007bff;
        border: none;
        border-radius: 10px;
        padding: 0.75rem;
        font-weight: 600;
        color: #fff;
        font-size: 1rem;
        transition: all 0.3s ease;
    }
    .btn-submit:hover { background-color: #0056b3; transform: scale(1.02); }

    .alert-popup {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
        min-width: 280px;
        display: none;
    }
</style>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5">
            <div class="reset-card">
                <h3 class="text-center text-primary mb-3 fw-bold">Quên mật khẩu</h3>
                <p class="text-center text-muted mb-4">Nhập email, chúng tôi sẽ gửi liên kết đặt lại mật khẩu.</p>

                <form id="resetForm">
                    @Html.AntiForgeryToken()
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Địa chỉ Email</label>
                        <input type="email" name="email" class="form-control" placeholder="nhapemail@example.com" required />
                    </div>
                    <button type="submit" class="btn-submit">Gửi liên kết đặt lại</button>
                </form>
            </div>
        </div>
    </div>
</div>

<div id="alertBox" class="alert alert-info alert-popup"></div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $("#resetForm").on("submit", function (e) {
            e.preventDefault();
            var formData = $(this).serialize();

            $.ajax({
                url: '/TaiKhoan/QuenMatKhauAjax',
                type: 'POST',
                data: formData,
                success: function (res) {
                    var box = $("#alertBox");
                    box.removeClass("alert-info alert-success alert-danger");

                    if (res.success) {
                        box.addClass("alert-success").html(res.message).fadeIn();
                    } else {
                        box.addClass("alert-danger").html(res.message).fadeIn();
                    }

                    setTimeout(() => box.fadeOut(), 5000);
                },
                error: function () {
                    $("#alertBox").addClass("alert-danger").html("❌ Lỗi hệ thống!").fadeIn();
                }
            });
        });
    </script>
}
